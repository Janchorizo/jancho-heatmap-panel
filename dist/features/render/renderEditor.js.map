{"version":3,"sources":["../../../src/features/render/renderEditor.ts"],"names":["renderEditor","scope","pathToTemplate","ctrl","panel","type","restrict","templateUrl","controller","RenderEditorController","d3","$scope","editor","panelCtrl","console","info","temp","render","colors","discrete_continuous","actualizarColores","target","panelDivId","dir","baseMapRoute","mapRoute","xml","mimeType","get","error","div","document","getElementById","removeChild","childNodes","appendChild","documentElement","renderFeature","scaleColor","value","thresholds","scaleLinear","domain","range"],"mappings":"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","file":"renderEditor.js","sourcesContent":["import * as d3 from '../../libs/d3/build/d3.js' ;\n\nexport class RenderEditorController {\n  constructor( $scope) {\n    $scope.editor = this;\n    this.panelCtrl = $scope.ctrl;\n    this.panel = this.panelCtrl.panel;\n  }\n\n  hola(){\n    console.info('Qu√© pasa chavalada');\n  }\n\n  invertirColores(){\n    let temp = this.panel.render.colors[0];\n    this.panel.render.colors[0] = this.panel.render.colors[2];\n    this.panel.render.colors[2] = temp;\n    if(this.panel.render.discrete_continuous != true){\n      this.actualizarColores();\n    }\n    this.panelCtrl.render();\n  }\n\n  actualizarMapa(){\n    let target = this.panel.panelDivId;\n    let dir = this.panel.render.baseMapRoute + this.panel.render.mapRoute;\n\n    d3.xml( dir).mimeType( \"image/svg+xml\").get( function( error, xml){\n      if( error){ throw( error);}\n      let div = document.getElementById( target);\n      div.removeChild(div.childNodes[0]);\n      div.appendChild(xml.documentElement);\n    });\n    this.panelCtrl.render();\n  }\n\n  actualizarColores(){\n    if(this.panel.render.discrete_continuous == true){\n      this.panelCtrl.renderFeature.scaleColor = (function( value){\n        if( value <= this.panel.render.thresholds[0]){\n          return( this.panel.render.colors[0]);\n        }else if( value <= this.panel.render.thresholds[1]){\n          return( this.panel.render.colors[1]);\n        }else{\n          return( this.panel.render.colors[2]);\n        }\n      });\n    }else{\n      this.panelCtrl.renderFeature.scaleColor =  d3.scaleLinear()\n        .domain( this.panel.render.domain)\n        .range( this.panel.render.colors);\n    }\n    this.panelCtrl.render();\n  }\n}\n\nexport function renderEditor( scope){\n  'use strict';\n  let pathToTemplate = 'public/plugins/' + scope.ctrl.panel.type + '/features/render/renderEditor.html';\n  return function(){\n    return{\n      restrict: 'E',\n      scope: true,\n      templateUrl: pathToTemplate,//'public/plugins/jancho-heatmap-panel/features/render/renderEditor.html',\n      controller: RenderEditorController,\n    };\n  };\n}\n"]}