{"version":3,"sources":["../../../src/features/render/renderEditor.ts"],"names":["renderEditor","scope","pathToTemplate","ctrl","panel","type","restrict","templateUrl","controller","RenderEditorController","d3","$scope","editor","panelCtrl","console","log","hola","info","temp","render","colors","discrete_continuous","actualizarColores","target","panelDivId","dir","baseMapRoute","mapRoute","xml","mimeType","get","error","div","document","getElementById","removeChild","childNodes","appendChild","documentElement","renderFeature","scaleColor","value","thresholds","scaleLinear","domain","range"],"mappings":"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","file":"renderEditor.js","sourcesContent":["import * as d3 from '../../libs/d3/build/d3.js' ;\n\nexport class RenderEditorController {\n  constructor( $scope) {\n    $scope.editor = this;\n    this.panelCtrl = $scope.ctrl;\n    this.panel = $scope.ctrl.panel;\n    console.log( $scope);\n    this.panelCtrl.hola();\n  }\n\n  hola(){\n    console.info('Qu√© pasa chavalada');\n  }\n\n  invertirColores(){\n    console.log('invertirColores');\n    let temp = this.panel.render.colors[0];\n    this.panel.render.colors[0] = this.panel.render.colors[2];\n    this.panel.render.colors[2] = temp;\n    if(this.panel.render.discrete_continuous != true){\n      this.actualizarColores();\n    }\n    this.panelCtrl.render();\n    this.panelCtrl.hola();\n  }\n\n  actualizarMapa(){\n    let target = this.panel.panelDivId;\n    let dir = this.panel.render.baseMapRoute + this.panel.render.mapRoute;\n\n    d3.xml( dir).mimeType( \"image/svg+xml\").get( function( error, xml){\n      if( error){ throw( error);}\n      let div = document.getElementById( target);\n      div.removeChild(div.childNodes[0]);\n      div.appendChild(xml.documentElement);\n    });\n    this.panelCtrl.render();\n  }\n\n  actualizarColores(){\n    console.log('actualizarColores');\n    if(this.panel.render.discrete_continuous == true){\n      this.panelCtrl.renderFeature.scaleColor = (function( value){\n        if( value <= this.panel.render.thresholds[0]){\n          return( this.panel.render.colors[0]);\n        }else if( value <= this.panel.render.thresholds[1]){\n          return( this.panel.render.colors[1]);\n        }else{\n          return( this.panel.render.colors[2]);\n        }\n      });\n    }else{\n      this.panelCtrl.renderFeature.scaleColor =  d3.scaleLinear()\n        .domain( this.panel.render.domain)\n        .range( this.panel.render.colors);\n    }\n    this.panelCtrl.render();\n  }\n}\n\nexport function renderEditor( scope){\n  'use strict';\n  let pathToTemplate = 'public/plugins/' + scope.ctrl.panel.type + '/features/render/renderEditor.html';\n  return function(){\n    return{\n      restrict: 'E',\n      scope: true,\n      templateUrl: pathToTemplate,//'public/plugins/jancho-heatmap-panel/features/render/renderEditor.html',\n      controller: RenderEditorController,\n    };\n  };\n}\n"]}