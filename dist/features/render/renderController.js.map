{"version":3,"sources":["../../../src/features/render/renderController.ts"],"names":["MetricsPanelCtrl","TimeSeries","_","d3","renderDefaults","renderEditor","Feature","$scope","panelController","ctrl","panel","defaults","cloneDeep","events","on","onInitEditMode","bind","onPanelInitialized","onRender","onSizeChange","addEditorTab","renderSala","panelDivId","data","a","target","document","getElementById","clientWidth","clientHeight","select","attr","actualizarColores","cargarPlano","render","baseMapRoute","mapRoute","discrete_continuous","scaleColor","value","thresholds","colors","scaleLinear","domain","range","dir","source","local","cargarPlanoLocal","remote","cargarPlanoRemoto","mapUrl","xml","mimeType","get","error","root","div","getElementsByClassName","hasChildNodes","removeChild","firstChild","appendChild","documentElement","h","style","split","w","window","fetch","then","response","text","insertAdjacentHTML","svg","t","transition","duration","ease","easeLinear","selectAll","elementIdentifyer","unknownDataColor","salas","d","metric","id","$","proxy","legend","exit","remove","enter","append","each","html"],"mappings":"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","file":"renderController.js","sourcesContent":["import {MetricsPanelCtrl} from 'app/plugins/sdk';\nimport TimeSeries from 'app/core/time_series2';\nimport _ from 'lodash';\nimport * as d3 from '../../libs/d3/build/d3.js' ;\n\nimport { renderDefaults } from \"./renderDefaults.js\";\nimport { renderEditor } from \"./renderEditor.js\";\n\n/**\n * @alias renderFeature\n * @classdesc <h2>render feature</h2>\n * Implementation for a feature.<br>\n * Makes use of the mediator pattern in order to subscribe the feature to\n * the plugin's event, through the $scope reference which is passed to it.\n * <br>\n * <br><h3>Functionaliy<h3><br>\n * This feature is responsible for representing data values in an svg, including <br>\n * the load of the svg in the DOM.\n * <i>Subscribed events</i>\n * <ul>\n *   <li>init-edit-mode</li>\n *   <li>panel-initialized</li>\n *   <li>render</li>\n * </ul>\n * @requires D3.js\n */\nexport default class Feature{\n  /**\n   * constructor - description <br>\n   * Important the use of _.cloneDeep to ensure that no two instances of the same plugin\n   * share references of the same variables.\n   *\n   * @param  {type} $scope A reference to the plugin's scope for the subscription to events\n   * @return {type}        New instance of Feature\n   */\n  constructor( $scope){\n      this.$scope = $scope;\n      this.panelController = $scope.ctrl;\n      this.panel = this.panelController.panel;\n\n      const defaults = _.cloneDeep(renderDefaults)\n      _.defaults( this.panelController.panel, defaults);\n\n      this.panelController.events.on( 'init-edit-mode', this.onInitEditMode.bind(this));\n      //this.panelController.events.on( 'data-received', this.onDataReceived);\n      this.panelController.events.on( 'panel-initialized', this.onPanelInitialized.bind(this));\n      this.panelController.events.on( 'render', this.onRender.bind(this));\n      this.panelController.events.on( 'panel-size-changed', this.onSizeChange.bind(this));\n      //this.panelController.events.on( 'refresh', this.onRefresh);\n  }\n\n  /**\n   * onInitEditMode - Handler for the event : init-edit-mode<br>\n   *\n   * @memberof renderFeature\n   */\n  onInitEditMode(){\n    this.panelController.addEditorTab( 'Render', renderEditor( this.$scope), 2);\n  }\n\n  /**\n   * onRender - Handler for the event : render<br>\n   * Requires of an element containing the svg to update based on the data\n   * @memberof renderFeature\n   */\n  onRender(){\n    this.renderSala( '#'+this.panel.panelDivId, this.panel.data);\n  }\n\n  onSizeChange(a){\n        const target = this.panel.panelDivId;\n        const panel = document.getElementById(target);\n\n        if(panel.clientWidth < panel.clientHeight){\n          d3.select('div#'+target+' div.image svg')\n            .attr('width','100%')\n            .attr('height','auto');\n        }else{\n          d3.select('div#'+target+' div.image svg')\n            .attr('width','auto')\n            .attr('height','100%');\n        }\n  }\n\n  /**\n   * onPanelInitialized - Handler for the event : panel-initialized <br>\n   * Renders the svg and data for the first time. Including :\n   * <ol>\n   * <li>Create a first instance of the color scale</li>\n   * <li>Load and append it to the specified element by the panelDivId identyfier</li>\n   * <li>Create an event for rendering the data over the svg</li>\n   * </ol>\n   *\n   * @memberof renderFeature\n   */\n  onPanelInitialized(){\n    this.actualizarColores();\n    this.cargarPlano( this.panel.panelDivId, this.panel.render.baseMapRoute + this.panel.render.mapRoute + \".svg\");\n    this.panelController.render();\n  }\n\n  /**\n   * actualizarColores - Changes the instance of color scale to be used by D3.<br><br>\n   * For discrete representation (fixed number of colors) an ad-hoc function is done.<br>\n   * For continous representation (range of colors) a D3.js scale function is used, based on <br>\n   * domain and color selected.\n   *\n   * @memberof renderFeature\n   */\n  actualizarColores(){\n    if(this.panel.render.discrete_continuous == true){\n      this.scaleColor = (function( value){\n        if( value <= this.panel.render.thresholds[0]){\n          return( this.panel.render.colors[0]);\n        }else if( value <= this.panel.render.thresholds[1]){\n          return( this.panel.render.colors[1]);\n        }else{\n          return( this.panel.render.colors[2]);\n        }\n      });\n    }else{\n      this.scaleColor =  d3.scaleLinear()\n        .domain( this.panel.render.domain)\n        .range( this.panel.render.colors);\n    }\n    this.panelController.render();\n  }\n\n  /**\n   * cargarPlano - Loads the svg resource into the DOM, hanging from the<br>\n   * element specified by the elementIdentifyer id attribute.\n   *\n   * @param  {type} target id attribute\n   * @param  {type} dir    svg resource url from where it is served\n   * @memberof renderFeature\n   */\n  cargarPlano( target, dir){\n    // target => id name\n    if(this.panel.render.source.local === true)\n        this.cargarPlanoLocal( target, dir)\n    else if(this.panel.render.source.remote === true)\n        this.cargarPlanoRemoto( target, this.panel.render.mapUrl)\n    this.panelController.render();\n  }\n\n  cargarPlanoLocal( target, dir){\n    d3.xml( dir).mimeType( \"image/svg+xml\").get( function( error, xml){\n    if( error){ throw( error);}\n      let root = document.getElementById(target);\n      let div = root.getElementsByClassName('image')[0]\n        while (div.hasChildNodes()) {  \n            div.removeChild(div.firstChild);\n        } \n      div.appendChild(xml.documentElement);\n        const panel = document.getElementById(target);\n        const h = (d3.select('div#'+target+' div.image svg').style('height').split('px')[0]);\n        const w = (d3.select('div#'+target+' div.image svg').style('width').split('px')[0]);\n\n          d3.select('div#'+target+' div.image svg')\n            .attr('viewBox', '0 0 '+w+' '+h)\n            .attr('preserveAspectRatio', 'xMinYMin meet');\n\n        if(panel.clientWidth < panel.clientHeight){\n          d3.select('div#'+target+' div.image svg')\n            .attr('width','100%')\n            .attr('height','auto');\n        }else{\n          d3.select('div#'+target+' div.image svg')\n            .attr('width','auto')\n            .attr('height','100%');\n        }\n\n    });\n  }\n\n  cargarPlanoRemoto( target, dir){\n    window.fetch(dir)\n    .then((response) => response.text())\n    .then(svg => {\n      let root = document.getElementById(target);\n      let div = root.getElementsByClassName('image')[0]\n\n        while (div.hasChildNodes()) {  \n            div.removeChild(div.firstChild);\n        } \n        div.insertAdjacentHTML(\"afterbegin\", svg);\n        const panel = document.getElementById(target);\n        const h = (d3.select('div#'+target+' div.image svg').style('height').split('px')[0]);\n        const w = (d3.select('div#'+target+' div.image svg').style('width').split('px')[0]);\n\n          d3.select('div#'+target+' div.image svg')\n            .attr('viewBox', '0 0 '+w+' '+h)\n            .attr('preserveAspectRatio', 'xMinYMin meet');\n\n        if(panel.clientWidth < panel.clientHeight){\n          d3.select('div#'+target+' div.image svg')\n            .attr('width','100%')\n            .attr('height','auto');\n        }else{\n          d3.select('div#'+target+' div.image svg')\n            .attr('width','auto')\n            .attr('height','100%');\n        }\n    });\n  }\n  /**\n   * renderSala - Renders data on the svg resource <br>\n   * Color applied to each element specified is provided by the function loaded in scaleColor.\n   *\n   * @param  {type} target DOM element from which it hangs the svg\n   * @param  {type} data   TimeSeries processed data, in the form of pairs [metric, value]\n   * @memberof renderFeature\n   */\n  renderSala (target, data){\n    var t = d3.transition()\n    .duration(750)\n    .ease(d3.easeLinear);\n\n    //ClearOutput\n    var t = d3.select(target+' svg').selectAll( '.'+this.panel.render.elementIdentifyer).style( 'fill', this.panel.render.unknownDataColor);\n\n    //Binding\n    var salas = d3.select(target+' svg').selectAll( '.'+this.panel.render.elementIdentifyer)\n\n    .data(data, function(d){ return d ? d.metric : this.id; });\n    //Update\n    salas\n      .transition(t)\n      .style('fill', $.proxy( function(d){ return this.scaleColor( d.value)}, this));\n\n    var legend = d3.select('div#'+this.panel.panelDivId).select('div.legend').selectAll('div.legendElement')\n      .data(data, d=>d.metric);\n\n    d3.select('div#'+this.panel.panelDivId).select('div.legend')\n      .style('display',(this.panel.render.legend===true)?'block':'none');\n\n    legend\n      .exit()\n        .remove();\n\n    legend\n      .enter()\n        .append('div')\n        .attr('class', 'legendElement')\n        .style('display','flex')\n        .each(function(){\n          d3.select(this).append('p');\n          d3.select(this).append('div');\n        });\n\n    legend.selectAll('div')\n        .style('width','0.8em')\n        .style('height','0.8em')\n        .style('border-radius','50%')\n        .style('margin', '0.3em 0.7em')\n        .style('background-color', $.proxy( function(d){ return this.scaleColor( d.value)}, this));\n    legend.selectAll('p')\n      .style('margin',0)\n      .style('display','inline-block')\n      .html(function(d){\n        return(d.metric+' ( '+d.value+' )')});\n\n  }\n}\n"]}